# THz Time Domain CNNs

This branch contains experiments testing the use of convolutional neural networks (CNNs) for tasks in THz time-domain material characterization. Simulated datasets are generated using a matrix transfer method, as described in Optical Waves in Layered Media by Pochi Yeh.

⸻

## File Overview
•	**Simulate.py**  
Efficient implementation of the matrix transfer method for simulating time-domain sample pulses from a reference pulse. Updated to run in linear time with significant performance improvements over the legacy version.  

•	**oldSimulate.py**  
Legacy version of the simulation code, preserved for reference and comparison.  

•   **Data_gen_efficient.py**  
Generates datasets of simulated time-domain pulses. Simulations are performed with 4096 time steps to avoid FFT-related artifacts, then down sampled to 1024 points.   Multiprocessing is used to accelerate data generation. Outputs are saved as .pt files.   

•	**Basic_CNN_ident.ipynb**
Implements a basic CNN to classify the number of layers in a simulated time-domain pulse. Currently optimized for up to 3 layers. Accuracy decreases with more layers; further experimentation with architectures and data volume is planned.  

•	**Data_collection.ipynb**  
Loads and validates datasets generated by Data_gen_efficient.py. Includes visualizations, summary statistics, and checks for data integrity using randomly sampled examples.

•	**UMAP_projection.ipynb**
Applies UMAP dimensionality reduction to visualize structural patterns and separability in the dataset.  
•	**utils.py**  
Utility functions for plotting and visualizing material characteristics, helpful during simulation validation and random sampling.

⸻

## Data Generation

Data is simulated using a matrix transfer method that models electromagnetic wave propagation through layered materials. This approach provides high fidelity synthetic data for training deep learning models. This method can be fine tuned by using reference pulses from a specific THz-TDS setup. Pulse propagation is calculated at high resolution (4096 points), then down sampled to 1024 points to match input requirements for CNNs while minimizing FFT-induced errors.